<!DOCTYPE html>
<html>
<head>
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
	<title>
		HelloUnity
	</title>
	<link rel="stylesheet" type="text/css" href="onepage-scroll.css">
	<link rel="stylesheet" type="text/css" href="animate.css">
</head>
<style>

/* 全局样式 */

*{
	/*font-family: "Microsoft Yahei";*/
	font-size: 16px;
	/*color: #666;*/
	box-sizing: border-box;
}

ul{
	padding-inline-start:0px;
}

button{
	outline: none;
	border-width: 0;
}

.anim{
	transition:all 0.25s linear;
}

.anim-linear{transition-timing-function: linear !important}
.anim-ease{transition-timing-function: ease !important}
.anim-ease-in{transition-timing-function: ease-in !important}
.anim-ease-out{transition-timing-function: ease-out !important}
.anim-ease-in-out{transition-timing-function: ease-in-out !important}


.max-size
{
	height: 100%;
	width: 100%;
}

.hide{
	display: none !important;
}

.undisplay
{
	visibility: hidden;
}

video:hover{
	transform: scale(1.2);
}

video{
	box-shadow: rgba(0, 0, 0, 0.12) 0px 2px 6px, rgba(0, 0, 0, 0.24) 0px 1px 2px;
}

/* 页面样式 */

.page1 { background-color: #ffffff;}
.page2 { background-color: #ffffff;}
.page3 { background-color: #ffffff;}
.page4 { background-color: #ffffff;}
p.title { position: relative; top: 35%; font: 700 40px;text-align: center;}

.h-text {
	font-size: 36px;
    letter-spacing: 8px;
}

.text2 {
	font-size: 24px;
    letter-spacing: 8px;
}

.loader-bg{
	height: 100%;
	width: 100%;
	position: fixed;
	z-index: 1000;
	/*background-color: #212121;*/
}

.loader-bg .loader{
	width: 120px;
	height: 120px;
	margin: auto;
	left: 0;
	right: 0;
	top: 0;
	bottom: 0;
	position: absolute;
}

.loader-trans{
	transform: scale(1.3);
}

.loader-bg .button{
	margin: auto;
	left: 0;
	right: 0;
	top: 0;
	bottom: 0;
	position: absolute;
	border-radius: 100%;
	
}

.loader-bg .button-origin{
	width: 50px;
	height: 50px;
	background: #bbb;
	opacity: 0.3;
	font-size: 6px;
}

.loader-bg .button-trans{
	transform: scale(1.8);
	opacity: 1;
}

.loader-bg .button:hover{
	background: #fff;
	transform: scale(2.0);
}

.loader-bg .button:active{
	background: #fff;
	transition:transform 2s linear;
	transform: scale(.8);
}


.video-container{
    display: flex;
    justify-content: flex-end;
    align-content: center;
    height: 100%;
    align-items: center;
    padding-right: 5%;
}

/* normal screen */
@media screen and (max-width: 1600px) {
	.video{
		width: 590px;
		height: 369px;
	} 

	.bg-img{
		position: absolute;
		left: -77px;
		bottom: -77px;
		width: 1477px;
		height: 830px;
	}
}

/* big screen */
@media screen and (min-width: 1600px) {
	.video{
		width: 768px;
		height: 480px;
	}
	.bg-img{
		position: absolute;
		left: -80px;
		bottom: -80px;
		width: 1920px;
		height: 1080px;
	}

}

.txt-shadow {
  text-shadow: 5px 5px 5px #ffffff;
}

.sub-title {
	position: absolute;left: 2.5%;top: 30px;
}

</style>
<body>
<div class="loader-bg">
	<img id="Mask" class="max-size hide"/>
	<div id="TempMask" class="max-size" style="background-color: black"></div>
	<img id="PuffSvg" class="loader" src="svg/puff.svg"/>
	<button id="EnterBtn" class="button button-origin undisplay anim anim-ease-out" >ENTER</button>
</div>

<audio id="bgAudio" loop="loop" src="audio/bg1.mp3"></audio>

<div class="main">
	<div class="page page1">
		<div class="h-text" style="position: absolute;right: 10px;top: 19px;">传送门终端</div>
		<div anim-name="fadeIn" class="max-size">
		<ul id="scene1" class="max-size">
			
			<li class="layer max-size" data-depth=".2">
				<img class="bg-img" src="image/b/5.png"/>
			</li>
			<li class="layer max-size" data-depth=".25">
				<img class="bg-img" src="image/b/1.png"/>
			</li>
			<li class="layer max-size" data-depth=".05">
				<p class="h-text" style="position: absolute;top: 30%;text-align: center;width: 100%">Hello Unity</p>
				<p style="position: absolute;bottom: 50px;text-align: center;width: 100%">滑动鼠标或点击键盘↓</p>
			</li>
		</ul>
		</div>
		
	</div>
	<div class="page page2">
		<ul anim-name="fadeIn" id="scene2" style="position: absolute;bottom: 0;margin-bottom:0" class="max-size">
			<li class="layer max-size" data-depth=".2">
				<img class="bg-img" src="image/b/3.png"/>
			</li>
			<li class="layer max-size" data-depth=".35">
				<img class="bg-img" src="image/b/1.png"/>
			</li>
			<li class="layer max-size" data-depth=".05">
				<p anim-name="fadeIn" class="text2 delay-1s txt-shadow" style="margin-top: 150px;margin-left: 5%;position: absolute;" >
					有时候还能回想起
				</p>
				<p anim-name="fadeIn" class="text2 delay-2s txt-shadow" style="margin-top: 230px;margin-left: 5%;position: absolute;" >
					第一次使用Unity的好奇
				</p>
				<p anim-name="fadeIn" class="text2 delay-3s txt-shadow" style="margin-top: 310px;margin-left: 5%;position: absolute;" >
					第一次完成UI的心情
				</p>
				<p anim-name="fadeIn" class="text2 delay-4s txt-shadow" style="margin-top: 390px;margin-left: 5%;position: absolute;" >
					第一次...
				</p>
				<div class="video-container">
					<video anim-name="fadeIn" class="video" autoplay="autoplay" loop="loop" muted="muted">
						<source src="video/P11.mp4" type="video/mp4"></source>
					</video>
				</div>
			</li>
		</ul>
		<div anim-name="slideInDown" class="h-text" style="position: absolute;left: 2.5%;top: 30px;">这就是开始？</div>
	</div>
	<div class="page page3">
		<ul anim-name="fadeIn" id="scene3" style="position: absolute;bottom: 0;margin-bottom:0" class="max-size">
			<li class="layer max-size" data-depth=".2">
				<img class="bg-img" src="image/b/4.png"/>
			</li>
			<li class="layer max-size" data-depth=".25">
				<img class="bg-img" src="image/b/1.png"/>
			</li>
			<li class="layer max-size" data-depth=".05">
				<p anim-name="fadeIn" class="text2 delay-1s txt-shadow" style="margin-top: 150px;margin-left: 25%;position: absolute;" >
					咻咻咻~~~
				</p>
				<p anim-name="fadeIn" class="text2 delay-2s txt-shadow" style="margin-top: 230px;margin-left: 25%;position: absolute;" >
					哒哒哒~~~
				</p>
				<p anim-name="fadeIn" class="text2 delay-3s txt-shadow" style="margin-top: 310px;margin-left: 25%;position: absolute;" >
					啪啪啪~~~
				</p>

				<div class="video-container">
					<video anim-name="fadeIn" class="video" autoplay="autoplay" loop="loop" muted="muted">
						<source src="video/P22.mp4" type="video/mp4"></source>
					</video>
				</div>
			</li>
		</ul>
		<div anim-name="slideInDown" class="h-text" style="position: absolute;left: 10px;top: 19px;">— The After Store —</div>
	</div>
	<div class="page page4">
		<ul anim-name="fadeIn" id="scene4" style="position: absolute;bottom: 0;margin-bottom:0" class="max-size">
			<li class="layer max-size" data-depth=".2">
				<img class="bg-img" src="image/b/2.png"/>
			</li>
			<li class="layer max-size" data-depth=".5">
				<img class="bg-img" src="image/b/1.png"/>
			</li>
			<li class="layer max-size" data-depth=".05">
				<p anim-name="fadeIn" class="text2 delay-1s txt-shadow" style="margin-top: 150px;margin-left: 25%;position: absolute;" >
					基于状态模式UI框架
				</p>
				<div class="video-container">
					<video anim-name="fadeIn" class="video" autoplay="autoplay" loop="loop" muted="muted">
						<source src="video/P31.mp4" type="video/mp4"></source>
					</video>
				</div>
			</li>
		</ul>
		<div anim-name="slideInDown" class="h-text" style="position: absolute;left: 10px;top: 19px;">— The After Store —</div>
	</div>
</div>


</body>
<script type="text/javascript" src="jquery-v3.3.1.min.js"></script>
<script type="text/javascript" src="onepage-scroll.min.js"></script>
<script type="text/javascript" src="jquery.parallax.js"></script>
<script type="text/javascript" src="parallax.js"></script>

<script type="text/javascript">
	// var pageCount = 
	var ATTR_ANIMNAME = "anim-name";
	var currentPageIdx = 1;
	var prevPageIdx = 1;
	var pageCount = $(".page").length;

	// 模拟加载完成
	var loadingLoop = setInterval(function(){
		if(IsResAllReady())
		{
			$("#PuffSvg").addClass("loader-trans");
			$("#EnterBtn").removeClass("undisplay").addClass("button-trans");
			$("#EnterBtn").one('click', function(){
				EnterClick($(this));
			});
			clearInterval(loadingLoop);
		}
		else
			return;
	},1000);

	function EnterClick(self)
	{
		$("#TempMask").addClass("hide");
		$("#Mask").removeClass("hide").attr("src","svg/mask.svg");
		self.addClass("hide");
		$("#PuffSvg").addClass("hide");
		setTimeout(function(){
			PlayPageAllAnim(1);
			PlayAudio();
		},500);
		setTimeout(function(){
			$("#Mask").addClass("hide");
		},1180);
	}

	function IsResAllReady()
	{
		for (var i = 0; i < $("audio").length; i++) {
			console.log("audio state",$("audio")[i].readyState);
			if ($("audio")[i].readyState != 4)
				return false;
		}
		for (var i = 0; i < $("video").length; i++) {
			console.log("video state",$("video")[i].readyState);
			if ($("video")[i].readyState != 4)
				return false;
		}

		return true;
	} 

	function PlayAudio() {
		var audio = document.getElementById('bgAudio');
		audio.volume = .5;
		if(audio.paused)
			audio.play();
	}

	$(".main").onepage_scroll({
	   sectionContainer: ".page",
	   easing: "ease",
	   animationTime: 1000,
	   pagination: true,
	   updateURL: false,
	   beforeMove: function(index) {
	   		
	   },
	   afterMove: function(index) {
	   		prevPageIdx = currentPageIdx;
	   		currentPageIdx = index;
	   		PlayPageAllAnim(currentPageIdx);
	   		InitPage(prevPageIdx);
	   },
	   loop: false,
	   keyboard: true,
	   responsiveFallback: false,
	   direction: "horizontal"
	});
	var parallax = new Parallax(document.getElementById('scene1'));
	var parallax2 = new Parallax(document.getElementById('scene2'));
	var parallax3 = new Parallax(document.getElementById('scene3'));
	var parallax4 = new Parallax(document.getElementById('scene4'));

	(function InitLayout(){
		for (var i = 1; i <= pageCount; i++) {
			InitPage(i);
		}
	})();

	function PlayPageAllAnim(pageIdx) 
	{
		var animtors = $(".page" + pageIdx).find('*['+ATTR_ANIMNAME+']');
		$.each(animtors,function(i,animtor){
			$(this).removeClass('hide').addClass($(this).attr(ATTR_ANIMNAME) + ' animated').one('webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend', function(){
    		});
		});
	};

	function InitPage(pageIdx)
	{
		var animtors = $(".page" + pageIdx).find('*['+ATTR_ANIMNAME+']');
		$.each(animtors,function(i,animtor){
			$(this).addClass('hide');
		});
	}
</script>

</html>